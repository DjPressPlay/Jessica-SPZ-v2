<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Zetsu Card — Schema-Accurate Renderer</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="color-scheme" content="dark">
<style>
  :root{
    --frame-color:#e63946;
    --frame-outer:#000;
    --text:#fff;
  }
  body{
    margin:0; background:#111; color:var(--text);
    font-family:"Orbitron",system-ui,Segoe UI,Arial,Helvetica,sans-serif;
    min-height:100vh; display:flex; align-items:center; justify-content:center; padding:16px;
  }
  .frameType{
    position:relative; overflow:hidden;
    border:12px solid var(--frame-outer); border-radius:14px;
    width:clamp(360px, 92vw, 460px);
  }
  .frameType-inner{
    position:relative; overflow:hidden; border:6px solid var(--frame-color); border-radius:10px;
    background:#1a1a1a;
  }
  .card-header, .card-art, .type-banner, .effect-box, .meta-block, .meta-bottom { position:relative; z-index:1; }
  .card-art{ position:relative; margin:10px; background:#222; aspect-ratio:4/3; border:3px solid var(--frame-color); border-radius:8px; overflow:hidden; }
  .card-art img{ width:100%; height:100%; object-fit:cover; display:block; }
  .stat-orb{ position:absolute; width:54px; height:54px; border-radius:50%; font-weight:800; font-size:1.02rem; display:flex; align-items:center; justify-content:center; border:3px solid #fff; box-shadow:0 2px 8px rgba(0,0,0,.4); }
  .stat-blue  { background:#3498db; top:6px;  left:6px; }
  .stat-red   { background:#e63946; bottom:6px; left:6px; }
  .stat-green { background:#2ecc71; bottom:6px; right:6px; }
</style>
</head>
<body>

<div class="frameType">
  <div id="inner" class="frameType-inner">
    <!-- Header -->
    <div class="card-header">
      <div class="card-id" id="card-id"></div>
      <div class="card-name"><span id="card-name" class="autoscale"></span></div>
      <div class="card-icon" id="card-icon"></div>
    </div>

    <!-- Artwork -->
    <div class="card-art">
      <img id="card-image" alt="" loading="lazy" decoding="async">
      <div class="stat-orb stat-blue"  id="level"></div>
      <div class="stat-orb stat-red"   id="atk"></div>
      <div class="stat-orb stat-green" id="def"></div>
    </div>

    <!-- Type Banner -->
    <div class="type-banner">
      <span id="tribute"></span>
      <span id="about"></span>
      <span id="type-emoji"></span>
    </div>

    <!-- Effects -->
    <div class="effect-box" id="effect-box"></div>

    <!-- Meta -->
    <div class="meta-block">
      <div>Sets: <span id="sets-line"></span></div>
      <div>Tags: <span id="tags-line"></span></div>
    </div>

    <!-- Footer -->
    <div class="meta-bottom">
      <div id="footer"></div>
      <div id="timestamp"></div>
      <div class="rarity" id="rarity"></div>
    </div>
  </div>
</div>

<script>
function safeParse(s){ try{ return JSON.parse(s) } catch { return null } }
function getCardFromLink(){
  const p = new URLSearchParams(location.search);
  if (!p.has("card")) return null;
  return safeParse(decodeURIComponent(p.get("card")));
}
const card = getCardFromLink() || {};

/* ===== Bind Enrich values directly ===== */
const $ = id => document.getElementById(id);
$("card-id").textContent   = card.id || "";
$("card-name").textContent = card.name || "";
$("card-icon").textContent = card.icon || "";

const img = $("card-image");
img.src = card.card_images?.[0]?.image_url || "";
img.alt = card.name ? card.name+" — artwork" : "Card artwork";

/* Stats: trust enrich.js */
$("level").textContent = card.level || 0;
$("atk").textContent   = card.atk   || 0;
$("def").textContent   = card.def   || 0;

/* Tribute string from enrich */
$("tribute").textContent   = card.tribute || "";
$("about").textContent     = card.about   || "";
$("type-emoji").textContent= card.icon    || "";

/* Effects */
const effBox = $("effect-box");
effBox.replaceChildren();
(card.effects||[]).forEach(e=>{
  const entry = document.createElement("div");
  entry.textContent = `${e.icons||""} ${e.emoji||""} ${e.text||""}`;
  effBox.append(entry);
});

/* Meta */
$("sets-line").textContent = (card.card_sets||[]).join(" ");
$("tags-line").textContent = (card.tags||[]).join(" ");
$("footer").textContent    = card.footer || "";
$("timestamp").textContent = card.timestamp || "";
$("rarity").textContent    = card.rarity || "";
</script>
</body>
</html>
